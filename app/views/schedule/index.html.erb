<!-- Preferred order:

Customer: name, custID
“Title of job”
Date of service
Customer: name, custID?
Contact 
Contact 
Contact 
         Total $/charge
         Net $ (fee shown) -->
<% if current_user.present? %>
  <div class="card card-style">
    <div class="content mt-3 mb-3">
      <h3>Schedule</h3>
      <p class='text-justify'>
          <% if !current_user&.manager? %>
            Schedule your purchased service, see the status of your pending service requests, and see all available times by service providers!
          <% end %>
          <% if current_user&.manager? %>
            As clients purchase your services the 'Pending' section will show you which clients have requested their service be complete. <br><br>

            After you have accepted the date and time to complete a service, it will be show in the 'Upcoming' section
          <% end %>
      </p>
    </div>
  </div>

  <div class="card card-style bg-theme pb-0 text-center">
    <div class="content">
      <div class="tab-controls tabs-round tab-animated tabs-medium tabs-rounded shadow-xl" 
        <% if current_user&.manager? %>
          data-tab-items="2" 
           data-tab-active="bg-green1-dark color-white">
          <a href="#" data-tab="tab-1"><i class="fa fa-calendar-check"></i> Upcoming<%= !@scheduledTimes.blank? ? " (#{@scheduledTimes.size})" : nil %></a>
          <a href="#" data-tab-active data-tab="tab-2"><i class="fa fa-sync"></i> Pending<%= !@bookingRequests.blank? ? " (#{@bookingRequests.size})" : nil %></a>
        <% else %>
            data-tab-items="3" 
             data-tab-active="bg-green1-dark color-white">
            <a href="#" data-tab="tab-4"><i class="fa fa-briefcase"></i> Request<%= !@timeBought.blank? ? " (#{@timeBought.size})" : nil %></a>
            <a href="#" data-tab="tab-1"><i class="fa fa-calendar-check"></i> Upcoming<%= !@scheduledTimes.blank? ? " (#{@scheduledTimes.size})" : nil %></a>
            <a href="#" data-tab-active data-tab="tab-2"><i class="fa fa-sync"></i> Pending<%= !@bookingRequests.blank? ? " (#{@bookingRequests.size})" : nil %></a>

        <% end %>
      </div>
        
      <div class="clearfix mb-3"></div>
        
      <div class="tab-content" id="tab-1">
        <div class="card card-style">
          <% if !@scheduledTimes.blank? %>
            <% @scheduledTimes.each do |h| %>
              <div class="content mb-3">
                <h2 class="text-center font-18 color-green2-dark"><%= h['title']%></h2>
                  <div class="text-center">
                        <div class="align-self-center text-center">
                          <h5 class="">
                          <%= h['buyerName'] %> #<%= h['buyerUUID'] %><br>
                          <%= link_to h['address'], "https://www.google.com/maps/place/#{h['address'].tr(" ", "+")}", target: "_blank" %><br>
                          
                          Start Time: <%= h['startTime']%>
                          </h5>
                            <p class="font-600 opacity-40 ">
                              Phone: <a href="tel:<%= h['buyerPhone'] %>"><%= h['buyerPhone'] %></a>
                              <br>

                              Email: <a href = "mailto:<%= h['buyerEmail'] %>"><%= h['buyerEmail'] %></a>
                            </p>
                        </div>
                        <div class="align-self-center">
                        </div>
                        <br>
                        <% if current_user.manager? %>
                          <div class="row">
                            <div class="col-12">
                              <%= form_for :cancel, url: cancel_path do |f| %>
                                <%= f.hidden_field :uuid, value: h['uuid'] %>
                                <%= button_tag( :class => "col-12 btn btn-sm rounded-sm bg-gray3-dark text-uppercase font-800") do %>
                                Cancel
                                <!-- Cancel <i class="fa fa-close"></i> -->
                                <% end %>

                              <% end %>
                            </div>
                          </div>
                        <% else %>
                          <div class="row">
                            <div class="col-md-12 align-self-center">
                              <%= form_for :cancel, url: cancel_path do |f| %>
                                <%= f.hidden_field :uuid, value: h['uuid'] %>
                                <%= f.submit "Cancel", class: "btn btn-sm col-md-6 rounded-sm bg-gray3-dark text-uppercase font-800"%>
                              <% end %>
                            </div>
                          </div>
                        <% end %>
                        
                  </div>
              </div>
            <% end %>
          <% end %>           
        </div>
      </div>

      <div class="tab-content" id="tab-2">
        <div class="card card-style">
          <% if !@bookingRequests.blank? %>
            <% @bookingRequests.each do |h| %>
              <div class="content mb-3">
                <h2 class="text-center font-18 color-green2-dark"><%= h['title']%></h2>
                  <div class="">
                        <div class="align-self-center text-center">
                          <h5 class="">
                          <%= h['buyerName'] %> #<%= h['buyerUUID'] %><br>
                          <%= link_to h['address'], "https://www.google.com/maps/place/#{h['address'].tr(" ", "+")}", target: "_blank" %><br>
                          Start Time: <%= h['startTime']%>
                          </h5>
                            <p class="font-600 opacity-40 ">
                              Phone: <a href="tel:<%= h['buyerPhone'] %>"><%= h['buyerPhone'] %></a>
                              <br>

                              Email: <a href = "mailto:<%= h['buyerEmail'] %>"><%= h['buyerEmail'] %></a>
                            </p>
                        </div>
                        <br>
                        <div class="align-self-center text-right">
                          <!-- <h2 class="font-18 color-green2-dark"><%= h['title']%></h2> -->
                          <p class="font-12 opacity-50">
                            
                          </p>
                        </div>
                        <% if current_user.manager? && h['buyerApproved?'] %>
                          <div class="row">
                            <div class="col-6">
                              <%= form_for :accept, url: acceptRequest_path do |f| %>
                                <%= f.hidden_field :uuid, value: h['uuid'] %>
                                <%= button_tag( :class => "col-12 btn btn-sm rounded-sm bg-green1-dark text-uppercase font-800") do %><i class="fa fa-check"></i>
                                <% end %>
                              <% end %>
                            </div>
                            <div class="col-6">
                              <%= form_for :cancel, url: cancel_path do |f| %>
                                <%= f.hidden_field :uuid, value: h['uuid'] %>
                                <%= button_tag( :class => "col-12 btn btn-sm rounded-sm bg-gray3-dark text-uppercase font-800") do %><i class="fa fa-close"></i>
                                <% end %>

                              <% end %>
                            </div>
                          </div>
                        <% else %>
                          <div class="row">
                            <div class="col-md-6">
                              <div class="align-self-center">
                                <a href="<%= service_path(id: h['timeSlotUUID']) %>" class="btn btn-sm col-md-12 rounded-sm bg-green1-dark text-uppercase font-800">View Service</a>
                              </div>
                              <br>
                            </div>
                            <div class="col-md-6">
                              <div class="align-self-center">
                                <%= form_for :cancel, url: cancel_path do |f| %>
                                  <%= f.hidden_field :uuid, value: h['uuid'] %>
                                  <%= f.submit "Cancel", class: "btn btn-sm col-md-12 rounded-sm bg-gray3-dark text-uppercase font-800"%>
                                <% end %>
                              </div>
                            </div>
                          </div>
                        <% end %>
                        
                  </div>
              </div>
            <% end %>
          <% end %>           
        </div>
      </div>

      <div class="tab-content" id="tab-4">
        <div class="card card-style">
          <% if !@timeBought.blank? %>
            <% @timeBought.each do |h| %>
              <div class="content mb-3">
                  <div class="">
                    <div class="align-self-center">
                        <h5 class=""><%= h['title'] %> (<%= h['remaining']%>)</h5>
                        <p class="font-600 opacity-40"><%= h['description']%></p>
                    </div>
                    <div class="align-self-center">
                      <a href="<%= new_book_it_path(timeBought: h) %>" class="btn btn-sm col-md-12 rounded-sm bg-green1-dark text-uppercase font-800">Request</a>
                    </div>
                  </div>
              </div>
            <% end %>
          <% end %>           
        </div>
      </div>

      <div class="tab-content" id="tab-3">
        <div class="card card-style">
          <% if !@availableTimes.blank? %>
            <% @availableTimes.each_with_index do |h,i| %>
              <div class="content mb-3">
                  <div class="">
                        <div class="align-self-center">
                            <h5 class=""><%= h['date']%>
                              <p class="font-600 opacity-40"><%= h['startTime']%> - <%= h['endTime']%></p>
                            </h5>
                        </div>
                        <div class="align-self-center">
                        </div>
                        <div class="align-self-center">
                            <a href="<%= new_book_it_path(timeBought: @timeBought, booking: h) %>" class="btn btn-sm col-md-12 rounded-sm bg-blue1-dark text-uppercase font-800">Book Now</a>
                        </div>
                  </div>
              </div>
            <% end %>
          <% end %>           
        </div>
      </div>
    </div>
  </div>
<% else %>
<div class="page-content header-clear-medium">
        
        <div class="card card-style">
            
            <div class="d-flex content mb-1">
                <!-- left side of profile -->
                <div class="flex-grow-1">
                    <h1 class="font-700">Book Now</h1>
                    <p class="mb-2">
                      All of your scheduled appointments will be posted here. Cancel an appointment anytime for free!
                    </p>
                </div>
                <!-- right side of profile. increase image width to increase column size-->
            </div>
            <!-- follow buttons-->
            <div class="content mb-0">
                <div class="row mb-0">
                    <div class="col-6">
                        <a href="<%= new_user_registration_path %>" class="btn btn-full btn-s rounded-s text-uppercase font-900 bg-green1-dark">Create Account</a>
                    </div>
                    <div class="col-6">
                        <a href="<%= new_user_session_path %>" class="btn btn-full btn-s rounded-s text-uppercase font-900 color-theme border-green1-dark">Login</a>
                    </div>
                </div>
            </div>
            
            <div class="divider mt-4 mb-0"></div>
        </div>
    </div>
<% end %>