<br>
<div class="card card-style">
  <div class="content">

    <div class="d-flex">
        <div class="flex-grow-1">
            <h1 class="font-30"><%= @product['name'].titleize %></h1>
            <p class="mt-n1 font-12 color-highlight mb-4">Purchase &amp; Book At Your Convenience</p>

        </div>
        <div class="flex-shrink-1">
            <h1 class="font-20">
              <div id="uniquePriceChange">
                $25<sup>.00</sup>
              </div>
            </h1>
            
            <span class="bg-green1-dark float-right rounded-xs text-uppercase font-900 font-9 pr-2 pl-2 pb-0 pt-0 mt-n1">Available</span>
        </div>
    </div>
    
    <div class="divider"></div>
    
    <div class="d-flex mt-4">
        <div class="flex-grow-1">
            <span class="font-11">Share with the World </span>
            <p class="mt-n2">
                <strong class="color-theme">Share or Save for Later</strong>
            </p>
        </div>
        <div class="flex-shrink-1 mt-1">
            <a href="#" data-menu="menu-share" class="icon icon-xs rounded-xl shadow-m ml-2 bg-blue2-dark"><i class="fa fa-share-alt"></i></a>
            <a href="#" data-menu="menu-share" class="icon icon-xs rounded-xl shadow-m ml-2 bg-red2-dark"><i class="fa fa-heart"></i></a>
        </div>
    </div>
    <%if current_user.stripeUserID == @connectAccount %>
      <div class="divider"></div>
      
      <div class="d-flex mt-4">
          <div class="flex-grow-1">
              <span class="font-11">Price Management</span>
              <p class="mt-n2">
                  <strong class="color-theme">Add, Update, &amp; Unlist Prices </strong>
              </p>
          </div>
          <div class="flex-shrink-1 mt-1">
              <a href="#" data-menu="menu-share" class="icon icon-xs rounded-xl shadow-m ml-2 bg-green1-dark"><i class="fa fa-plus"></i></a>
              <a href="#" data-menu="menu-share" class="icon icon-xs rounded-xl shadow-m ml-2 bg-yellow1-dark"><i class="fa fa-list"></i></a>
          </div>
      </div>
    <% end %>
  </div>
</div> 


<div class="card card-overflow card-style">
  <div class="content">
  <%= form_for :addToCart, url: cart_path(id: @connectAccount), method: :patch do |f|  %>
      <div class="input-style has-icon input-style-2 input-required pb-1">
          <span class="color-highlight input-style-1-active">Price</span>
          <em>(required)</em>
          <%= f.select :sellerItem, @prices.map{|p,i| [number_to_currency(p['unit_amount'].to_f * 0.01, precision: 2), "#{p['unit_amount']}-#{p['id'].split("price_")[1]}" "#{!p['transform_quantity'].blank? ? "-package" : ""}"  ]}, required: true %>
          
      </div>
      <div class="input-style has-icon input-style-2 input-required pb-1">
          <span class="color-highlight input-style-1-active">Quantity</span>
          <em>(required)</em>
          <%= f.select :quantity, 1..100, required: true %>
      </div> 
      <p class="mt-n1 font-12 color-highlight mb-0" id='packageSelected' style="display: none;"><i class="fa fa-info mr-3"></i> Package Selected</p>
      <% if current_user&.stripeUserID.blank? || !current_user&.stripeSourceVerified %>
        <%= link_to "Setup Payment", '/profile', class: 'btn btn-full bg-yellow2-dark btn-m text-uppercase font-800 rounded-sm' %>
      <% else %>
        <%= f.submit "Add To Cart", class: "col-md-12 btn btn-m mt-2 mb-4 btn-full bg-green1-dark text-uppercase font-900" %>
      <% end %> 
    <% end %> 
    <h5>Description</h5>
    <%= @product['description'] %>

    <div class="clearfix"></div>                
    <div class="divider mt-2 mb-3"></div>
  </div>
</div>

<script type="text/javascript">
  var priceLoaded = document.querySelector("#uniquePriceChange");


  priceLoaded.innerHTML =  "$"+(document.getElementById('addToCart_sellerItem').value.split("-")[0] * 0.01).toFixed(2)

  document.getElementById('addToCart_sellerItem').addEventListener('change', function() {
    selectedV = this.value
    console.log('You selected: ', selectedV);
    var priceVisible = document.querySelector("#uniquePriceChange");
    priceVisible.innerHTML = "$"+(this.value.split("-")[0] * 0.01).toFixed(2);

    let re = 'package';
    let str = selectedV;
    let index = str.search(re);
    var packageAlert = document.querySelector("#packageSelected");

    if (index > 0) {

      packageAlert.style.display = 'inline';
    } else {
      packageAlert.style.display = 'none';
    }
    console.log(index);
  });
  

  window.onload = function() {
    var selectedOnLoad = document.getElementById('addToCart_sellerItem');

    console.log(selectedOnLoad.value);
    selectedV = selectedOnLoad.value

    let re = 'package';
    let str = selectedV;
    let index = str.search(re);
    var packageAlert = document.querySelector("#packageSelected");

    if (index > 0) {

      packageAlert.style.display = 'inline';
    } else {
      packageAlert.style.display = 'none';
    }
    console.log(index);
  };

</script>

















